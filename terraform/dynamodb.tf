resource "aws_dynamodb_table" "vulnerability_collector_table" {
  name           = "${var.prefix}-vulnerability_collector"
  billing_mode   = "PAY_PER_REQUEST"
  hash_key       = "hash_key"

  attribute {
    name = "hash_key"
    type = "S"
  }

}

resource "aws_dynamodb_table_item" "init-items" {
  table_name = aws_dynamodb_table.vulnerability_collector_table.name
  hash_key = aws_dynamodb_table.vulnerability_collector_table.hash_key
  item = <<EOF
${file(var.nvd_urls_file)}
EOF
}